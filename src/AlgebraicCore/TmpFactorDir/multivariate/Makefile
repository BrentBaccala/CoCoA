# Makefile for CoCoALib/src/AlgebraicCore/TmpFactorDir/multivariate/ directory.

COCOA_ROOT=../../../..
include $(COCOA_ROOT)/configuration/autoconf.mk
CWD=src/AlgebraicCore/TmpFactorDir/multivariate/
DEPEND_FILE=Makefile_dependencies

SRCS=DUPZgcd_free_basis.c DUPZexgcd.c DUPZbivariate_lift.c DMPZfactors.c \
     DMPZfactor.c DMPZlist.c DMPZeval.c DMPZ.c DUPZinterp.c DMPZinterp.c \
     DMPZevalQ.c DMPZfactor_modp.c DMPZgcd.c DMPZ_to_DUPZ.c \
     DMPZlift.c DMPZ_to_DUPFF.c DMPZinteger_content.c DMPZmap_to_univariate.c
#DUPFFbivariate_lift3.c

OBJS=$(SRCS:.c=.o)

%.o: %.c
	$(COMPILE) -I. -I.. -I../linalg -c -o $@ $<

default: $(OBJS)
	ar -rcuS $(COCOA_LIB) $(OBJS)

.PHONY: clean clean-local
clean: clean-local
	@echo "Cleaned CoCoALib/$(CWD)"

clean-local:
	/bin/rm -f $(OBJS) "$(DEPEND_FILE).old"  ./*~

.PHONY: veryclean
veryclean: clean-local
	/bin/rm -f  "$(DEPEND_FILE)"
	touch "$(DEPEND_FILE)"  # Trick, otherwise make complains after a veryclean
	@echo "Verycleaned CoCoALib/$(CWD)"


# This target checks whether we should really build DEPEND_FILE
.PHONY: dependencies
dependencies:
	@if [ -f "$(COCOA_HDR)" -a \! "$(DEPEND_FILE)" -nt "$(COCOA_HDR)" ] ; \
	then \
	  $(MAKE) create-dependencies; \
	fi

# This is the target which really does rebuild the DEPEND_FILE
.PHONY: create-dependencies
create-dependencies:
	@if [ -f "$(DEPEND_FILE)" ] ; \
	then \
	  mv -f "$(DEPEND_FILE)" "$(DEPEND_FILE).old" ; \
	fi
	@echo "Rebuilding dependencies in <CoCoALib>/$(CWD)"
	@echo "##################################################################"   >> $(DEPEND_FILE)
	@echo "# Dependencies for directory $(CWD)"                                  >> $(DEPEND_FILE)
	@echo "#              for CoCoALib version $(VERSION)"                       >> $(DEPEND_FILE)
	@echo "# DO NOT EDIT: this file is automatically generated; to regenerate"   >> $(DEPEND_FILE)
	@echo "# run \`make dependencies' in the CoCoALib root directory."           >> $(DEPEND_FILE)
	@echo "##################################################################"   >> $(DEPEND_FILE)
	@echo                                                                        >> $(DEPEND_FILE)
	for srcfile in $(SRCS); \
	do \
	  objfile=`basename $$srcfile .c`.o; \
	  $(CXX) -I$(COCOA_ROOT)/include $(GMP_INCLUDE) -I. -I.. -I../linalg -MM "$$srcfile" -MQ "$$objfile" >> $(DEPEND_FILE); \
	  echo >> $(DEPEND_FILE); \
	done


$(DEPEND_FILE):
	@touch $(DEPEND_FILE)  # to avoid infinite recursion in make!

include $(DEPEND_FILE)


$(OBJS): $(COCOA_ROOT)/configuration/autoconf.mk
